# ============================================
# Stash Auto Vision - GPU Configuration
# ============================================
# Copy this file to .env for GPU enabled platforms and customize for your environment

# Media Paths
# Path to your test video files (will be mounted to /media/videos in containers)
# Testing with Charades dataset for frame/scene testing
TEST_MEDIA_PATH=/tests/data
# Path to your live video files (will be mounted to /data in containers)
SERVER_MEDIA_PATH=/mnt/user/movies

# Docker Configuration
DOCKER_NETWORK=stash-auto-vision-network
DOCKER_RUNTIME=nvidia

# Service Ports
VISION_API_PORT=5010
FRAME_SERVER_PORT=5001
SCENES_PORT=5002
FACES_PORT=5003
SEMANTICS_PORT=5004
OBJECTS_PORT=5005
JOBS_VIEWER_PORT=5020
REDIS_PORT=6379

# Frame Server (GPU Mode)
FRAME_SERVER_DOCKERFILE=Dockerfile
FRAME_EXTRACTION_METHOD=opencv_cuda
OPENCV_DEVICE=cuda
ENABLE_FALLBACK=true  # Enable automatic fallback: opencv -> pyav_hw -> pyav_sw -> ffmpeg
ENABLE_ENHANCEMENT=false  # Enable face enhancement
ENHANCEMENT_MODEL=codeformer  # gfpgan or codeformer
MAX_ENHANCEMENT_PIXELS=2073600 # 1080p

# Scenes Service (GPU Mode)
SCENES_DOCKERFILE=Dockerfile
SCENES_DETECTOR=pyscenedetect_cuda
SCENES_THRESHOLD=27.0  # Default threshold for ContentDetector (0.0-100.0, can be overridden per-request)

# Faces Service (GPU Mode)
FACES_DOCKERFILE=Dockerfile
INSIGHTFACE_MODEL=buffalo_l
INSIGHTFACE_DEVICE=cuda
INSIGHTFACE_COMPUTE_TYPE=float16
FACES_MIN_CONFIDENCE=0.9  # Default confidence threshold (0.0-1.0, can be overridden per-request)
FACES_MIN_QUALITY=0.0  # Default minimum quality threshold (0.0-1.0, can be overridden per-request)
FACES_ENHANCEMENT_QUALITY_TRIGGER=0.5  # Default quality trigger for enhancement (0.0-1.0, can be overridden per-request)

# Semantics Service (GPU Mode) - Phase 2+
SEMANTICS_DOCKERFILE=Dockerfile
CLIP_MODEL=ViT-B/32
CLIP_DEVICE=cuda
SEMANTICS_STUB_MODE=true  # Set to false when implementing
SEMANTICS_MIN_CONFIDENCE=0.5  # Default confidence threshold for CLIP (0.0-1.0, can be overridden per-request)

# Objects Service (GPU Mode) - Phase 2+
OBJECTS_DOCKERFILE=Dockerfile
YOLO_MODEL=yolo-world-m
YOLO_DEVICE=cuda
OBJECTS_STUB_MODE=true  # Set to false when implementing
OBJECTS_MIN_CONFIDENCE=0.5  # Default confidence threshold for YOLO (0.0-1.0, can be overridden per-request)

# Cache Configuration
CACHE_TTL=31536000  # seconds (1 year - for job history retention)

# Frame Storage Configuration
FRAME_TTL_HOURS=2  # Automatic cleanup after 2 hours
FRAME_DIR=/tmp/frames

# Processing
PROCESSING_MODE=sequential  # or 'parallel'

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
